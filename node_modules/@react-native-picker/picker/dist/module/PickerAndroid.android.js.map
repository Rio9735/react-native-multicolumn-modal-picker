{"version":3,"sources":["PickerAndroid.android.js"],"names":["React","findNodeHandle","NativeSyntheticEvent","processColor","UIManager","AndroidDialogPickerNativeComponent","AndroidDropdownPickerNativeComponent","MODE_DROPDOWN","PickerAndroid","props","ref","pickerRef","useRef","useImperativeHandle","viewManagerConfig","getViewManagerConfig","mode","blur","Commands","dispatchViewManagerCommand","current","focus","items","selected","useMemo","Children","toArray","children","map","child","index","value","selectedValue","enabled","color","contentDescription","label","style","processedColor","backgroundColor","onSelect","useCallback","nativeEvent","position","onValueChange","filter","item","setNativeProps","Picker","rootProps","accessibilityLabel","onBlur","onFocus","prompt","dropdownIconColor","dropdownIconRippleColor","testID","numberOfLines","forwardRef"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * @flow strict-local\n */\n\n'use strict';\n\nimport * as React from 'react';\nimport {\n  findNodeHandle,\n  NativeSyntheticEvent,\n  processColor,\n  UIManager,\n} from 'react-native';\nimport AndroidDialogPickerNativeComponent from './AndroidDialogPickerNativeComponent';\nimport AndroidDropdownPickerNativeComponent from './AndroidDropdownPickerNativeComponent';\n\nconst MODE_DROPDOWN = 'dropdown';\n\nimport type {TextStyleProp} from 'StyleSheet';\n\ntype PickerAndroidProps = $ReadOnly<{|\n  children?: React.Node,\n  style?: ?TextStyleProp,\n  selectedValue?: ?(number | string),\n  enabled?: ?boolean,\n  mode?: ?('dialog' | 'dropdown'),\n  onBlur?: (e: NativeSyntheticEvent<undefined>) => mixed,\n  onFocus?: (e: NativeSyntheticEvent<undefined>) => mixed,\n  onValueChange?: ?(itemValue: ?(string | number), itemIndex: number) => mixed,\n  prompt?: ?string,\n  testID?: string,\n  dropdownIconColor?: string,\n  numberOfLines?: ?number,\n|}>;\n\ntype PickerRef = React.ElementRef<\n  | typeof AndroidDialogPickerNativeComponent\n  | typeof AndroidDropdownPickerNativeComponent,\n>;\n\n/**\n * Not exposed as a public API - use <Picker> instead.\n */\nfunction PickerAndroid(props: PickerAndroidProps, ref: PickerRef): React.Node {\n  const pickerRef = React.useRef(null);\n\n  React.useImperativeHandle(ref, () => {\n    const viewManagerConfig = UIManager.getViewManagerConfig(\n      props.mode === MODE_DROPDOWN\n        ? 'RNCAndroidDialogPicker'\n        : 'RNCAndroidDropdownPicker',\n    );\n    return {\n      blur: () => {\n        if (!viewManagerConfig.Commands) {\n          return;\n        }\n        UIManager.dispatchViewManagerCommand(\n          findNodeHandle(pickerRef.current),\n          viewManagerConfig.Commands.blur,\n          [],\n        );\n      },\n      focus: () => {\n        if (!viewManagerConfig.Commands) {\n          return;\n        }\n        UIManager.dispatchViewManagerCommand(\n          findNodeHandle(pickerRef.current),\n          viewManagerConfig.Commands.focus,\n          [],\n        );\n      },\n    };\n  });\n\n  const [items, selected] = React.useMemo(() => {\n    // eslint-disable-next-line no-shadow\n    let selected = 0;\n    // eslint-disable-next-line no-shadow\n    const items = React.Children.toArray(props.children).map((child, index) => {\n      if (child === null) {\n        return null;\n      }\n      if (child.props.value === props.selectedValue) {\n        selected = index;\n      }\n\n      const {enabled = true} = child.props;\n\n      const {color, contentDescription, label, style = {}} = child.props;\n\n      const processedColor = processColor(color);\n\n      return {\n        color: color == null ? null : processedColor,\n        contentDescription,\n        label,\n        enabled,\n        style: {\n          ...style,\n          color: style.color ? processColor(style.color) : null,\n          backgroundColor: style.backgroundColor\n            ? processColor(style.backgroundColor)\n            : null,\n        },\n      };\n    });\n    return [items, selected];\n  }, [props.children, props.selectedValue]);\n\n  const onSelect = React.useCallback(\n    ({nativeEvent}: PickerItemSelectSyntheticEvent) => {\n      const {position} = nativeEvent;\n      const onValueChange = props.onValueChange;\n\n      if (onValueChange != null) {\n        if (position >= 0) {\n          const children = React.Children.toArray(props.children).filter(\n            (item) => item != null,\n          );\n          const value = children[position].props.value;\n          if (props.selectedValue !== value) {\n            onValueChange(value, position);\n          }\n        } else {\n          onValueChange(null, position);\n        }\n      }\n\n      // The picker is a controlled component. This means we expect the\n      // on*Change handlers to be in charge of updating our\n      // `selectedValue` prop. That way they can also\n      // disallow/undo/mutate the selection of certain values. In other\n      // words, the embedder of this component should be the source of\n      // truth, not the native component.\n      if (pickerRef.current && selected !== position) {\n        // TODO: using setNativeProps is deprecated and will be unsupported once Fabric lands. Use codegen to generate native commands\n        pickerRef.current.setNativeProps({\n          selected,\n        });\n      }\n    },\n    [props.children, props.onValueChange, props.selectedValue, selected],\n  );\n\n  const Picker =\n    props.mode === MODE_DROPDOWN\n      ? AndroidDropdownPickerNativeComponent\n      : AndroidDialogPickerNativeComponent;\n\n  const rootProps = {\n    accessibilityLabel: props.accessibilityLabel,\n    enabled: props.enabled,\n    items,\n    onBlur: props.onBlur,\n    onFocus: props.onFocus,\n    onSelect,\n    prompt: props.prompt,\n    selected,\n    style: props.style,\n    dropdownIconColor: processColor(props.dropdownIconColor),\n    dropdownIconRippleColor: processColor(props.dropdownIconRippleColor),\n    testID: props.testID,\n    numberOfLines: props.numberOfLines,\n  };\n\n  return <Picker ref={pickerRef} {...rootProps} />;\n}\n\nexport default React.forwardRef<PickerAndroidProps>(PickerAndroid);\n"]}